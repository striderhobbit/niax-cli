<div class="content" *ngIf="resourceTable != null">
  <form class="table-columns" (change)="updateResourceTableColumns()">
    <table>
      <tr
        *ngFor="let column of resourceTable.columns | keyvalue : preserveOrder"
      >
        <td>{{ column.key }}</td>
        <td>
          <input
            [(ngModel)]="column.value.include"
            name="include-{{ column.key }}-checkbox"
            type="checkbox"
          />
        </td>
      </tr>
    </table>
  </form>
  <table>
    <thead>
      <tr>
        <th
          *ngFor="
            let column of resourceTable.columns
              | keyvalue : preserveOrder
              | filter : 'value.include'
          "
        >
          {{ column.key }}
        </th>
      </tr>
    </thead>
    <tbody
      *ngFor="
        let rowsPage of resourceTable.rowsPages | keyvalue : preserveOrder
      "
    >
      <tr
        *ngIf="
          rowsPage.value.items == null &&
          isConnected(resourceTable, rowsPage.value)
        "
        (intersection)="
          fetchResourceTablePageItems(resourceTable, rowsPage.key)
        "
        observeIntersection
      >
        â‹¯
      </tr>
      <tr
        *ngFor="let row of rowsPage.value.items"
        (viewInit)="$event.scrollIntoView({ block: 'start' })"
        [ignoreViewInit]="row.resource.id !== resourceTable.resourceId"
        observeViewInit
      >
        <td
          *ngFor="let field of row.fields"
          [class.nullish]="field.value == null"
          [ngSwitch]="field.type"
        >
          <input
            *ngSwitchCase="'boolean'"
            (change)="patchResourceItem(resourceTable, field)"
            [(ngModel)]="field.value"
            type="checkbox"
          />
          <input
            *ngSwitchCase="'number'"
            (change)="patchResourceItem(resourceTable, field)"
            [(ngModel)]="field.value"
            type="number"
          />
          <input
            *ngSwitchCase="'string'"
            (change)="patchResourceItem(resourceTable, field)"
            [(ngModel)]="field.value"
            type="text"
          />
        </td>
      </tr>
    </tbody>
  </table>
</div>
