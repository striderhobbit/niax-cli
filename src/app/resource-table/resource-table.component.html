<table>
  <thead>
    <tr (contextmenu)="resourceTableColumnsComponent.focus()">
      <th
        *ngFor="let column of resourceTable.columns | filter : 'include'"
        (click)="togglePrimaryPath(column)"
        [attr.data-index]="resourceTable.primaryPaths.indexOf(column.path) + 1"
        [class.descending]="column.order === 'desc'"
        [class.primary]="column.sortIndex != null"
      >
        {{ column.path }}
      </th>
    </tr>
    <tr>
      <app-resource-table-columns
        (columnsChange)="updateResourceTableColumns()"
        (primaryPathsChange)="writeBackPrimaryPaths()"
        [resourceTable]="resourceTable"
        #resourceTableColumnsComponent
      ></app-resource-table-columns>
    </tr>
  </thead>
  <tbody *ngFor="let rowsPage of resourceTable.rowsPages">
    <tr
      *ngIf="rowsPage.deferred && isConnected(rowsPage)"
      (intersection)="fetchResourceTableRows(rowsPage.pageToken)"
      observeIntersection
    >
      â‹¯
    </tr>
    <tr
      *ngFor="let row of rowsPage.items"
      (viewInit)="$event.scrollIntoView({ block: 'start' })"
      [viewInitIgnored]="row.resource.id !== resourceTable.params.resourceId"
      observeViewInit
    >
      <td
        *ngFor="let field of row.fields"
        [class.nullish]="field.value == null"
        [ngSwitch]="field.type"
      >
        <input
          *ngSwitchCase="'boolean'"
          (change)="patchResourceItem(field)"
          [(ngModel)]="field.value"
          type="checkbox"
        />
        <input
          *ngSwitchCase="'number'"
          (change)="patchResourceItem(field)"
          [(ngModel)]="field.value"
          type="number"
        />
        <input
          *ngSwitchCase="'string'"
          (change)="patchResourceItem(field)"
          [(ngModel)]="field.value"
          type="text"
        />
      </td>
    </tr>
  </tbody>
</table>
