<app-resource-table-columns
  (columnsChange)="updateResourceTableColumns()"
  (primaryPathsChange)="onPrimaryPathsChanged()"
  [resourceTable]="resourceTable"
></app-resource-table-columns>
<table>
  <thead>
    <tr>
      <th *ngFor="let column of resourceTable.columns | filter : 'include'">
        {{
          column.sortIndex != null ? (column.order === "desc" ? "↑" : "↓") : ""
        }}{{ column.path }}
      </th>
    </tr>
  </thead>
  <tbody *ngFor="let rowsPage of resourceTable.rowsPages">
    <tr
      *ngIf="rowsPage.deferred && isConnected(rowsPage)"
      (intersection)="fetchResourceTableRows(rowsPage.pageToken)"
      observeIntersection
    >
      ⋯
    </tr>
    <tr
      *ngFor="let row of rowsPage.items"
      (viewInit)="$event.scrollIntoView({ block: 'start' })"
      [viewInitIgnored]="row.resource.id !== resourceTable.params.resourceId"
      observeViewInit
    >
      <td
        *ngFor="let field of row.fields"
        [class.nullish]="field.value == null"
        [ngSwitch]="field.type"
      >
        <input
          *ngSwitchCase="'boolean'"
          (change)="patchResourceItem(field)"
          [(ngModel)]="field.value"
          type="checkbox"
        />
        <input
          *ngSwitchCase="'number'"
          (change)="patchResourceItem(field)"
          [(ngModel)]="field.value"
          type="number"
        />
        <input
          *ngSwitchCase="'string'"
          (change)="patchResourceItem(field)"
          [(ngModel)]="field.value"
          type="text"
        />
      </td>
    </tr>
  </tbody>
</table>
